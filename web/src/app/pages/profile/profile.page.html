<div class="flex max-w-7xl mx-auto px-4 pt-6 gap-6">
  <!-- Sidebar -->
  <div class="w-64 flex-shrink-0 space-y-4">
    <div class="card bg-base-100 shadow-md items-center p-6">
      <div class="avatar">
        <div class="w-32 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2">
          <img
            src="https://img.freepik.com/premium-vector/default-avatar-profile-icon-social-media-user-image-gray-avatar-icon-blank-profile-silhouette-vector-illustration_561158-3383.jpg"
            alt="Profile Picture" />
        </div>
      </div>
      <h2 class="mt-4 text-xl font-bold text-center">{{ username }}</h2>
      <p class="text-sm text-center text-base-content/70">
        {{ roles.join(', ') }}
      </p>
    </div>
  </div>

  <!-- Main Content -->
  <div class="flex-1">
    <!-- Tabs -->
    <div role="tablist" class="tabs tabs-boxed mb-4">
      <a role="tab" class="tab tab-active" (click)="activeTab = 'overview'"
        [class.tab-active]="activeTab === 'overview'">Overview</a>
      <a role="tab" class="tab" (click)="activeTab = 'security'"
        [class.tab-active]="activeTab === 'security'">Security</a>
      <a role="tab" class="tab" (click)="activeTab = 'history'" [class.tab-active]="activeTab === 'history'">History</a>
    </div>

    <!-- Tab Content -->
    <div *ngIf="activeTab === 'overview'" class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <!-- Subscription Stat -->
      <div class="card bg-base-100 shadow-md">
        <div class="card-body flex flex-col gap-2">
          <div class="flex items-center justify-between">
            <span class="font-medium">Subscription</span>
            <div class="radial-progress text-primary" style="--value: 80; --size: 3rem" role="progressbar">
              20
            </div>
          </div>
          <div class="text-2xl font-bold">
            20 <span class="text-sm">/ 30</span>
          </div>
          <div class="text-sm text-success flex items-center gap-1">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="size-4" viewBox="0 0 16 16">
              <path fill-rule="evenodd" d="..." clip-rule="evenodd" />
            </svg>
            Left Days
          </div>
        </div>
      </div>

      <!-- Joined -->
      <div class="card bg-base-100 shadow-md">
        <div class="card-body">
          <div class="font-medium">Joined</div>
          <div class="text-2xl font-bold">12 Jun 2025</div>
          <div class="text-sm text-success flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="size-4" viewBox="0 0 16 16">
              <path fill-rule="evenodd" d="..." clip-rule="evenodd" />
            </svg>
            21% more than last month
          </div>
        </div>
      </div>

      <!-- Uploaded Videos -->
      <div class="card bg-base-100 shadow-md md:col-span-2">
        <div class="card-body">
          <div class="font-medium">Uploaded Videos</div>
          <div class="text-2xl font-bold">25</div>
          <div class="text-sm text-success flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="size-4" viewBox="0 0 16 16">
              <path fill-rule="evenodd" d="..." clip-rule="evenodd" />
            </svg>
            21% more than last month
          </div>
        </div>
      </div>
    </div>

    <!-- Security Tab -->
    <div *ngIf="activeTab === 'security'" class="card bg-base-100 shadow-md">
      <div class="card-body space-y-4">

        <div class="flex items-center gap-10">

          <span>
            Change Password:
          </span>


          <button class="btn btn-secondary" (click)="submitPasswordChange()">
            Change Password
          </button>
        </div>

        <div class="flex items-center justify-between mb-4">
          <h2 class="text-xl font-bold">Active Sessions</h2>
          <button class="btn btn-sm btn-error" (click)="terminateAllSessions()" [disabled]="sessions.length <= 1">
            Terminate All
          </button>
        </div>

        <table class="table w-full">
          <thead>
            <tr>
              <th>#</th>
              <th>Session ID</th>
              <th>IP</th>
              <th>Device</th>
              <th class="text-right">Action</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let session of sessions; let i = index"
              [ngClass]="{ 'bg-primary/10': session.id === currentSessionId }">
              <th>{{ i + 1 }}</th>
              <td>
                {{ session.id }}
                <span *ngIf="session.id === currentSessionId" class="badge badge-sm badge-info ml-2">Current</span>
              </td>
              <td>{{ session.ip }}</td>
              <td>{{ session.device }}</td>
              <td class="text-right">
                <button class="btn btn-xs btn-outline btn-error" (click)="terminateSession(session.id)"
                  [disabled]="session.id === currentSessionId">
                  Terminate
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>


    <!-- History Tab -->
    <div *ngIf="activeTab === 'history'" class="card bg-base-100 shadow-md">
      <div class="card-body">
        <h2 class="text-lg font-bold mb-4">Watch History</h2>
        <p class="text-sm mb-4">
          You can clear your entire watch history here.
        </p>
        <div class="flex justify-start items-center gap-10 w-full">
          <span>Watching History:</span>
          <button class=" btn btn-error" (click)="openClearWatchHistoryConfirm()">
            Clear
          </button>
        </div>
        <div class="flex items-center gap-10 w-full">
          <span>User Settings:</span>
          <button class=" btn btn-error" (click)="openClearWatchHistoryConfirm()">
            Clear
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<app-confirm-modal #confirmClearHistoryModal (confirmed)="clearWatchHistory()"></app-confirm-modal>