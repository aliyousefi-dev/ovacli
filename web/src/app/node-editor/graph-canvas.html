<div #graphContainer class="w-full h-full relative bg-base-100" [class.isPanning]="this.canvasStatus.isPanning"
    (mousedown)="onMouseDown($event)" (mouseup)="onMouseUp()" (mousemove)="onDocumentMouseMove($event)"
    appNodeEditorHost (hostEvents)="handleHostEvent($event)">
    <div class="absolute bottom-5 left-5 z-10">
        <app-canvas-status-bar [canvasStatusData]="this.canvasStatus"></app-canvas-status-bar>
    </div>

    <div class="absolute top-5 left-5 z-10">
        <app-shortcut-info />
    </div>

    <div class="absolute top-5 right-5 z-10">
        <button class="btn" (click)="canvasStatus.resetView()">Reset View</button>
    </div>


    <app-context-menu [canvasStatus]="canvasStatus"></app-context-menu>



    <svg class="graph-svg" [attr.width]="this.canvasStatus.containerWidth"
        [attr.height]="this.canvasStatus.containerHeight">
        <g [attr.transform]="transform">
            <defs>
                <pattern id="smallGrid" width="10" height="10" patternUnits="userSpaceOnUse">

                    <path d="M 10 0 L 0 0 L 0 10" fill="none" stroke="currentColor" stroke-opacity="0.3"
                        stroke-width="0.5" />

                </pattern>

                <pattern id="grid" width="100" height="100" patternUnits="userSpaceOnUse">

                    <rect width="100" height="100" fill="url(#smallGrid)" />

                    <path d="M 100 0 L 0 0 L 0 100" fill="none" stroke="currentColor" stroke-opacity="0.4"
                        stroke-width="1" />

                </pattern>
            </defs>



            <rect x="-10000" y="-10000" width="20000" height="20000" fill="url(#grid)"
                (click)="this.deselectAllNodes()" />

            @for (node of nodes; track $index) {
            <svg:g app-square-node [nodeData]="node" [scale]="canvasStatus.scale" (nodeClicked)="onNodeClick($event)">
            </svg:g>
            }

        </g>
    </svg>

    @if(this.canvasStatus.selectionBox.isDrawing){
    <div class="absolute border border-blue-500 bg-blue-500/30 pointer-events-none" [style.left.px]="selectBoxX"
        [style.top.px]="selectBoxY" [style.width.px]="selectWidth" [style.height.px]="selectHeight">
    </div>
    }
</div>